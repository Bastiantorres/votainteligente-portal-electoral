{% extends "base.html" %}
{% load staticfiles %}
{% load i18n %}
{% load thumbnail %}
{% load bootstrap_tags %}
{% block extrajs %}
{% endblock extrajs %}

{% block content %}
<!-- ModalCommentsForAProposal -->
<div class="modal fade loadFromUrl" id="proposalComments" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">{% trans 'Actualiza los comentarios' %}</h4>
      </div>
      <div class="modal-body">
        ...
      </div>
    </div>
  </div>
</div>
<!-- Modal ModerateProposal -->
<div class="modal fade loadFromUrl" id="moderateProposal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">{% trans '¿Deseas aceptar Propuesta Popular?' %}</h4>
      </div>
      <div class="modal-body">
          ...
      </div>
    </div>
  </div>
</div>

<div>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script type="text/javascript" src="{% static 'js/jquery.gridAccordion.min.js' %}"></script>
  <!-- Featured Elections  -->
  <div class="contenedorDestacado fondo-blanco">
    <h1>{% blocktrans %}¡Terrible de bienvenid@!{% endblocktrans %}</h1>
    <h2>{% blocktrans %}¡Eres parte de nuestro equipo!{% endblocktrans %}</h2>
    <p>Aquí podrás ver y moderar los elementos de VotaInteligente </p>

    <table class="table">
        <tr>
            <td>Area</td>
            <td>Problema</td>
            <td>Solución</td>
            <td>Cuándo?</td>
            <td>Aliados</td>
            <td>Acciones</td>
        </tr>
    {% for proposal in proposals.all %}
        <tr>
            <td>{{proposal.area}}</td>
            <td>{{proposal.data.problem}}</td>
            <td>{{proposal.data.solution}}</td>
            <td>{{proposal.data.when}}</td>
            <td>{{proposal.data.allies}}</td>
            <td>
                <a data-toggle="modal" data-target="#proposalComments" 
                    data-url="{% url 'backend_staff:popular_proposal_comments' pk=proposal.id %}">
                    <i class="fa fa-pencil-square-o"></i> Editame!
                </a>
                <a data-toggle="modal" data-target="#moderateProposal"
                    data-url="{% url 'backend_staff:moderate_proposal' pk=proposal.id %}">
                    <i class="fa fa-gavel"></i>
                </a>
            </td>
        </tr>
    {% endfor %}
    </table>
  </div>

</div>
<script>
$(function(){
    $('.loadFromUrl').on('show.bs.modal', function (event) {
      var anchor = $(event.relatedTarget) // Button that triggered the modal
      var modal = $(this)
      var body = modal.find('.modal-body');
      body.load(anchor.data('url'));
    })
});
</script>
{% endblock content %}

{% block extrafooter %}
{% endblock extrafooter %}

